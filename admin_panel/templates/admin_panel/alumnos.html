{% extends "admin_panel/base_admin.html" %}
{% load static %}

{% block title %}Gestión de Alumnos | SCODA{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/usuarios.css' %}">
    <link rel="stylesheet" href="{% static 'css/alumnos.css' %}">
{% endblock %}

{% block content %}

<div class="container py-4">
    
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h5 class="text-success fw-bold mb-0">
            <i class="bi bi-people-fill me-2"></i> Listado de Alumnos
        </h5>

        <div class="d-flex gap-2 align-items-center">

            <!-- Buscador rápido -->
            <input 
                type="text"
                id="buscadorAlumnos"
                class="form-control form-control-sm"
                placeholder="Buscar alumno..."
                style="max-width: 260px;"
            >

            <!-- Botón agregar familia -->
            <button id="btnAbrirModal" class="btn btn-success btn-sm d-flex align-items-center">
                <i class="bi bi-person-plus me-1"></i><span>Agregar Familia</span>
            </button>

        </div>
    </div>

    <!-- Tabla -->
    <div class="table-responsive shadow-sm">
        <table class="table table-hover align-middle" id="tablaAlumnos">
            <thead class="table-success text-center">
                <tr>
                    <th>#</th>
                    <th>RUN</th>
                    <th>Nombre</th>
                    <th>Curso</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody class="text-center">
            </tbody>
        </table>
    </div>

</div>

<!-- Modales-->
{% include "admin_panel/includes/alumnos_modales.html" %}
{% include "admin_panel/includes/alumnos_detalle_modal.html" %}

<div id="notificacion"></div>

<!-- ========================================================= -->
<!--MODAL CONFIRMAR ELIMINACIÓN-->
<!-- ========================================================= -->

<div class="modal fade" id="modalConfirmarEliminar" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">

      <div class="modal-header bg-danger text-white">
        <h5 class="modal-title">
          <i class="bi bi-exclamation-triangle-fill me-2"></i> Confirmar eliminación
        </h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body text-center">
        <p class="mb-2">¿Seguro que deseas eliminar este alumno?</p>
        <small class="text-muted">Esta acción no se puede deshacer.</small>
      </div>

      <div class="modal-footer d-flex justify-content-between">
        <button class="btn btn-secondary" data-bs-dismiss="modal">
          <i class="bi bi-x-circle me-1"></i> Cancelar
        </button>
        <button id="btnConfirmarEliminar" class="btn btn-danger">
          <i class="bi bi-trash-fill me-1"></i> Eliminar
        </button>
      </div>

    </div>
  </div>
</div>

<!-- Loader -->
<div id="loader">
    <div class="spinner-border text-success" role="status"></div>
    Cargando...
</div>

{% endblock %}

{% block extra_js %}
    {% now "U" as timestamp %}
    <script src="{% static 'js/alumnos.js' %}?v={{ timestamp }}"></script>

    <script>
        function volverDashboard() {
            window.location.href = "/panel/dashboard/";
        }
    </script>
{% endblock %}
